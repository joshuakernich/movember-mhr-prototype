<!DOCTYPE html>
<html>
<head>
	<title>Workshop Demo</title>
	<style type="text/css">
		.screen, .screen-container, .qr-prompt{
			width: 400px;
			height: 700px;
			margin: auto;
			background: white;
			text-align: center;
			
			position: relative;
			display: inline-block;
			vertical-align: top;
			
			color: white;
			background: black;
			overflow: hidden;
			vertical-align: middle;
		}


		.screen{
			position: absolute;
			top: 0px;
			left: 0px;
		}

		@font-face {
			font-family: "HeaderFont";
			src: url("./font-teko/Teko-Regular.ttf");
		}

		@font-face {
			font-family: "BodyFont";
			src: url("./Overpass-Light.ttf");
		}

		@font-face {
		  font-family: BodyFont;
		  src: url("./Overpass-Bold.ttf");
		  font-weight: bold;
		}	

		body{
			background: #333;
			font-family: "BodyFont";
			text-align: center;
			margin: 0px;
			padding: 0px;
		}

		@keyframes jiggle{
			0%{
				transform: rotate(1deg);
			}
			100%{
				transform: rotate(-1deg);
			}
		}

		.sticker{
			display: inline-block;
			margin: 15px;
			position: relative;	

			animation-name: jiggle;
			animation-iteration-count: infinite;
			animation-duration: 0.2s;
			cursor: pointer;
		}

		.sticker.still{
			animation: none;
			cursor: default;
		}

		.sticker.image{
			width: 200px;
			height: 150px;
			background-size: contain;
			background-position: center;
			background-repeat: no-repeat;
		}

		.sticker.text{
			padding: 5px 10px 0px;
			border: 3px solid white;
			color: white;
			font-weight: normal;
		
			transform: rotate(-5deg);
			background: orange; 
			text-transform: uppercase;
			font-size: 40px;
			box-shadow: 0px 1px 5px rgba(0,0,0,0.3);
			font-family: "HeaderFont";
			text-shadow: 0px 2px 0px #F25031;
			white-space: nowrap;
		}

		.sticker.text.n0{ background: #F7B752; text-shadow: 0px 2px 0px red; }
		.sticker.text.n1{ background: #99DB4D; text-shadow: 0px 2px 0px green; }
		.sticker.text.n2{ background: #82C8F2; text-shadow: 0px 2px 0px blue; }
		.sticker.text.n3{ background: #E66376; text-shadow: 0px 2px 0px red; }

		video{
			position: relative;
			
			transition: all 0.5s;
		}

		.timer{
			position: absolute;
			width: 100%;
			left: 0px;
			bottom: -10px;
			height: 10px;
			transition: 5s all;
			transition: all 0.5s;
			background: rgba(0,0,0,0.5);
			line-height: 0px;
			transition: all 2s;
		}	

		.timer .timer-ticker{
			background: white;
			height: 100%;
			display: inline-block;
			width: 50%;

		}

		.timer.active{
			bottom: 100px;
		}

		.overlay{
			position: absolute;
			top:0px;
			left: 0px;
			width: 100%;
			height: 100%;
			padding-top: 100px;
			box-sizing: border-box;
		}

		.overlay:after,.overlay:before{
			content: "";
			position: absolute;
			bottom: -110px;
			left: 0px;
			height: 100px;
			background: #111;
			width: 100%;
			text-align: center;
			transition: all 0.5s;
		}

		.overlay:after{
			top: -110px;
			bottom: auto;
		}

		.overlay.active:before{
			transition: all 2s;
			bottom: 0px;
		}

		.overlay.active:after{
			transition: all 2s;
			top: 0px;
		}

		.sticker-party{
			position: absolute;
			top: 100px;
			left: 0px;
			text-align: center;
			width: 100%;

		}

		video.zoom{
			transform: scale(2);
			transition: all 5s;
		}

		.options{
			display: inline-block;
			vertical-align: middle;
			margin: 10px;
			padding: 10px;
			background: white;
		}

		input{
			color: white;
		}

		.overlay{
			pointer-events: none;
		}

		.play{
			width: 100%;
			height: 100%;
			position: absolute;
			top:0px;
			left:0px;
			font-size: 100px;
			color: white;
			background: transparent;
		}

		.stop, .remember{
			display: none;
			position: absolute;
			top:0px;
			left: 0px;
			width: 100%;
			height: 100%;
			padding-top: 100px;
			box-sizing: border-box;
			background: rgba(0,0,0,0.5);
			color: white;
		}


		.remember{
			background: rgba(255,255,255,0.8);
		}

		.remember p{
			background: white;
			color: black;
			text-align: center;
			padding: 40px;
		}

		.next, .next-screen, .carry-on{
			display: block;
			width: 80%;
			margin: 0px 10%;
			font: inherit;
			margin-bottom: 10px;
			padding: 5px 0px 0px;
			color: white;
			background: #1C44CE;
			font-size: 1.2em;
			border: none;
			font-family: "HeaderFont";
			text-transform: uppercase;
			font-size: 1.8em;
			font-weight: normal;
		}

		.next-screen, .carry-on{
			position: absolute;
			bottom: 40px;
		}

		.swipe-prompt{
			display: none;
			position: absolute;
			top:0px;
			left:0px;
			right: 0px;
			bottom: 0px;
			opacity: 1;
			transition: 1s all;

		}

		.swipe-prompt.swiping{
			opacity: 0;
		}

		.prompt{
			font-family: "HeaderFont";
			background: #1C44CE;
			padding: 5px 10px 0px;
			border-radius: 5px;
			display: inline-block;
			color: white;
			text-transform: uppercase;
			font-size: 35px;
			position: relative;
			text-align: center;
			top: -30px;
		}

		.prompt:after{
			content: "";
			width: 0; 
			height: 0; 
			border-left: 20px solid transparent;
			border-right: 20px solid transparent;
			border-top: 20px solid #1C44CE;

			display: block;
			position: absolute;
			bottom: -20px;
			left: calc(50% - 20px);
		}

		.stop-banner{
			background: #1C44CE;
			padding: 20px;
			text-align: center;
		}

		.stop-banner h1{
			font-family: "HeaderFont";
			padding: 0px;
			margin:0px;
			font-weight: normal;
			font-size: 5em;
		}

		.stop-banner h2{
			font-family: "BodyFont"
			padding: 0px;
			margin:0px;
			font-weight: normal;
			font-size: 1em;
		}

		.swipe-prompt{
			background: rgba(0,0,0,0.4);
		}

		.finger{
			position: absolute;
			left:20%;
			top:20%;
			width: 0px;
			height: 0px;

			animation-name: swipe;
			animation-iteration-count: infinite;
			animation-duration: 1.5s;
		}

		.finger:after{
			content: "";

			width: 100px;
			height: 100px;
			background-image: url('./finger.png');
			background-size: contain;
			background-position: center;
			background-repeat: no-repeat;
			
			position: absolute;
			left: -50px;
			top: 0px;
			display: block;
		}

		@keyframes swipe{
			0%{
				opacity: 0;
				left:20%;
				top:20%;
				transform: rotate(-15deg);
			}
			10%{
				opacity: 1;
				left:20%;
				top:20%;
				transform: rotate(-15deg);
			}
			30%{
				left:70%;
				top:30%;
				transform: rotate(15deg);
			}
			60%{
				left:30%;
				top:40%;
				transform: rotate(-15deg);
			}
			90%{
				left:80%;
				top:50%;
				transform: rotate(25deg);
				opacity: 1;
			}
			100%{
				left:80%;
				top:50%;
				transform: rotate(25deg);
				opacity: 0;
			}
		}

		.nav button{
			display: inline-block;
			
			height: 30px;
			width: 30px;
			margin-right: 1px;
			font-family: "BodyFont";
			border: none;
			position: relative;
			background: white;

			
			cursor: pointer;
			outline: none;

		}



		.workshop-handoff{
			position: absolute;
			top: 0px;
			left: 0px;
			right: 0px;
			bottom: 0px;
			background: #1C44CE;
			display: none;

			box-sizing: border-box;
			
			font-size: 25px;
			font-family: "HeaderFont";
			background-position: center;
			background-repeat: no-repeat;
			background-size: 150px;
		}

		.workshop-handoff h1{
			font-size: 35px;
		}

		.workshop-timer{
			position: absolute;
			top: 0px;
			left: 0px;
			right: 0px;
			bottom: 0px;
			background: #1C44CE;
			display: block;

			box-sizing: border-box;
			padding-top: 50px;
			font-size: 25px;
			font-family: "HeaderFont";
			background-position: center;
			background-repeat: no-repeat;
			background-size: 150px;

		}

		.workshop-timer button{
			border: 1px solid white;
		}



		

		.static{
			position: absolute;
			top: 0px;
			left:0px;
			right: 0px;
			bottom: 0px;
			background-size: cover;
			background-position: center;
			background-repeat: no-repeat;
		}

		.popup{
			transform: scale(0);
			transition: all 0.5s;
		}

		.popup.reveal{
			transform: scale(1);
		}

		.stopwatch{
			width: 200px;
			height: 200px;
			border: 10px solid white;
			border-radius: 150px;
			margin: auto;
			box-sizing: border-box;
			position: relative;
		}

		@keyframes tick{
			0%{
				transform: rotate(0deg);
			}
			100%{
				transform: rotate(360deg);
			}
		}

		.stopwatch:after,.stopwatch:before{
			content: "";
			width: 40px;
			height: 10px;
			background: white;
			position: absolute;
			top: -10px;
			left: 10px;
			transform: rotate(-30deg);
		}

		.stopwatch:after{
			left: 130px;
			transform: rotate(30deg);
		}

		.stopwatch-hand{
			width: 2px;
			height: 80px;
			position: absolute;
			left: 89px;
			top: 15px;
			background: white;
			animation: tick;
			animation-duration: 30s;
			transform-origin: 1px 79px;
			animation-iteration-count: infinite;
			animation-timing-function: steps(240);
		}

		.stopwatch-hand:after{
			content: "";
			width: 10px;
			height: 10px;
			position: absolute;
			border: 2px solid white;
			position: absolute;
			bottom: -5px;
			left: -5px;
			border-radius: 100px;
			background: #1C44CE;
		}

		.qr-prompt{
			color: blue;
			display: none;
		}

		.qr-prompt img{
			width: 200px;
		}


		.instruct{
			position: absolute;
			top: 0px;
			left: 0px;
			width: 100%;
			height: 100%;
			background: rgba(255,255,255,0.8);
			text-align: left;
			padding: 30px;
			box-sizing: border-box;
			color: black;
		}

		.instruct h1{
			font-family: "HeaderFont";
			padding: 0px;
			margin:0px;
			font-weight: normal;
			font-size: 2.5em;
			color: rgba(28,68,206);
			text-align: center;
		}


	</style>
	<script type="text/javascript" src='./jquery-3.4.1.min.js'></script>
	<script type="text/javascript">
		$(function(){

			var isWorkshopMode = (window.location.href.indexOf('student')>-1);

			if(isWorkshopMode){
				toScreen(0);
			} else {
				toScreen(1);
			}

			function onNav(){
				var idx = $('.nav button').index(this);
				toScreen(idx);
			}

			$('.screen').each(function(i){
				$('<button>'+(i+1)+'</button>').appendTo('.nav').click(onNav);
			})

			

			var MESS = 15;
			var SCATTER = {cx:200,cy:350,rx:200,ry:350}
			var iMoment = 0;
			var iReflection = 0;

			var moments = [
				{start:32,end:40,options:['DISASTER!','./sticker/explosion.png','$^#&%!']},
				{start:60,end:70,options:['SO EMBARASSING!','MASSIVE FAIL!','./sticker/facepalm.png']},
				{start:90,end:100,options:['100% LOSER','DISAPPOINTED','SCREW-UP']},
			]
			
			var videoLive;
			var iVideoTicker;

			function tickSticker(){
				if(moments[iMoment] && !moments[iMoment].isShown && videoLive.currentTime > moments[iMoment].start){
					moments[iMoment].isShown = true;

					$('.overlay').empty();
					$('.sticker-party').empty();

					$("<div class='prompt'>What's he thinking?</div>").appendTo('.sticker-party');
					$("<br>").appendTo('.sticker-party');

					for(var s in moments[iMoment].options){
						var $s = $('<div class="sticker n'+s+'">').appendTo('.sticker-party').click(onSticker);

						if(moments[iMoment].options[s][0] == '.') $s.addClass('image').css({'background-image':'url('+moments[iMoment].options[s]+')'});
						else $s.addClass('text').html(moments[iMoment].options[s]);

						$("<br>").appendTo('.sticker-party');
					}
					$('.overlay').addClass('active');
				}

				if(moments[iMoment] && videoLive.currentTime > moments[iMoment].end){
					videoLive.playbackRate = 0;
				}

				if(moments[iMoment] && videoLive.currentTime > moments[iMoment].start){
					$('.timer').addClass('active');
					var p = (videoLive.currentTime-moments[iMoment].start)/(moments[iMoment].end-moments[iMoment].start);
					$('.timer-ticker').width(p*100+'%');
				}
			}

			function tickReflection(){

				if(videoLive.currentTime > (videoLive.duration/2 + (videoLive.duration/2/MESS)*iReflection)){

					while(stickerPack.length < moments.length){
						var $s =  $('<div class="sticker still text n0">').text(moments[stickerPack.length].options[stickerPack.length]);
						stickerPack.push($s)
					}
					
					var progress = iReflection/MESS;
					var drain = 1 - progress*progress*progress;


					var iRandom = Math.floor(Math.random()*stickerPack.length);
					var $s = stickerPack[iRandom].clone().appendTo('.overlay');
					$s.css({transform:'scale('+(0.5+Math.random()*1)+')'});
					$s.css({transform:'scale(1)'});
					

					var r = (iReflection*137.5)*(Math.PI/180);
					var x = SCATTER.cx + Math.cos(r)*SCATTER.rx*drain;
					var y = SCATTER.cy + Math.sin(r)*SCATTER.ry*drain;

					x = x-$s.outerWidth()/2;
					y = y-$s.outerHeight()/2;

					x = Math.max(0,Math.min(400-$s.outerWidth(),x));
					y = Math.max(0,Math.min(700-$s.outerHeight(),y));

					$s.css({position:'absolute',left:x,top:y});
					
					
					iReflection++;
				}
			}

			function forceSelection(){
				$('.sticker').eq(0).trigger('click');
			}

			/*function onStopSticker(e){

				var o = $(this).offset();

				$('.sticker-party .sticker').each(function(){
					var o2 = $(this).offset();
					var dx = o2.left-o.left;
					var dy = o2.top-o.top;
					var d = Math.sqrt(dx*dx+dy*dy);

					if(d == 0){
						dx = dy = 50;
					}

					if(d<150) $(this).addClass('dying').animate({top:'+='+dy*5,left:'+='+dx*5},500,function(){
						
						$(this).css({opacity:0});
						if($('.sticker:not(.dying)').length == 0){
							$('.swipe-prompt').hide();
							$('.remember').show();
						}
					});
				})
			}*/
			
			var stickerPack = [];

			function onSticker(e){
				$('.sticker-party').empty();
				$(e.target).addClass('still').appendTo('.sticker-party').css({top:'150px',transform:'scale(2) rotate(-5deg)'}).delay(2000).animate({opacity:0});
				$('.overlay').removeClass('active');
				$('.timer').removeClass('active');
				iMoment++;

				stickerPack.push( $(e.target).clone() );

				$('video').removeClass('zoom');
				videoLive.playbackRate = 1;
			}


		

			$('video').on('ended',onVideoEnd);

			function onVideoEnd(){
				if($(videoLive).closest('.screen-stop-swipe').length){
					$('.stop').show();
					setTimeout(function(){
						var o = $('.screen-container').offset();
						$('.qr-prompt').css({display:'inline-block',opacity:0,left:200}).animate({opacity:1,left:0},1000);
						$('.screen-container').css({left:200}).animate({top:0,left:0},1000);
					},1500);
				}
				else{
					nextScreen(this);
				} 
			}

			$('.stop button').click(function(){
				$('.stop').hide();
				$('.swipe-prompt').show();

				var iTickStick = setInterval(function(){

					$('.dead').each(function(){
						var d = $(this).data();
						var p = $(this).position();
						d.dy += 1;
						p.left += d.dx;
						p.top += d.dy;
						$(this).css(p);

						if(p.top>900) $(this).addClass('gone')
					});


					if($('.sticker').length == $('.gone').length){
						clearInterval(iTickStick);
						nextScreen(this);
						
					}

				},20);
			});

			var isMouseDown = false;

			

			$('.swipe-prompt').on('mousedown',function(e){
				$(this).addClass('swiping');
				isMouseDown = true;

				var o = $('.screen').offset();

				wasx = e.pageX - o.left;
				wasy = e.pageY - o.top;
			})

			$(window).on('mouseup',function(){
				isMouseDown = false;
			})

			var wasx = 0;
			var wasy = 0;

			$('.swipe-prompt').on('mousemove',function(e){
				if(isMouseDown){

					var o = $('.screen-container').offset();

					var x = e.pageX - o.left;
					var y = e.pageY - o.top;

					
					
					$('.sticker:not(.dead)').each(function(){
						var p = $(this).position();
						var dx = p.left + $(this).outerWidth()/2 - x;
						var dy = p.top + $(this).outerHeight()/2 - y;
						//var d = Math.sqrt(dx*dx+dy*dy);

						if(Math.abs(dx)<$(this).outerWidth()/2 && Math.abs(dy)<$(this).outerHeight()/2){
							
							
							$(this).addClass('dead').data({dx:x-wasx,dy:y-wasy});
						}
					})

					wasx = x;
					wasy = y;


				}
			});

			window.doFinishActivity = function(){
				//doPostReflection();
				nextScreen($('iframe')[0]);
			}

			
			$('.click-to-hide').click(function(){
				$(this).hide();
			})

			$('.click-to-next-screen').click(nextScreen);

			function nextScreen(scope){

				

				if(scope.target) scope = scope.target;

				var iScreen = $('.screen').index( $(scope).closest('.screen') ) + 1;
				toScreen(iScreen);
			}

			function toScreen(iScreen){

				clearInterval(iVideoTicker);
				if(videoLive) videoLive.pause();

				var $s = $('.screen').hide().eq(iScreen).show().css({opacity:0}).animate({opacity:1},1000,function(){
					
					if(isWorkshopMode) h$(this).find('.popup').addClass('reveal');

				});

				if($s.hasClass('screen-video')){
					videoLive = $s.find('video')[0];
					videoLive.play();
				}

				if($s.hasClass('screen-stickers')){
					iVideoTicker = setInterval(tickSticker,100);
				}

				if($s.hasClass('screen-stop-swipe')){
					iVideoTicker = setInterval(tickReflection,100);
				}

				if($s.hasClass('screen-strategy')){
					$('iframe')[0].contentWindow.postMessage('hello', '*');
				}
				
			}
		})
	</script>
</head>
<body>
	<div class="screen-container">
		<div class="screen screen-signup">
			<div class="static click-to-next-screen" style='background-image:url(./screen-signup.jpg)'></div>
			<div class="static click-to-hide" style='background-image:url(./screen-team-code.jpg)'></div>
		</div>
		<div class="screen screen-trailer">
			<div class="static" style='background-image:url(./trailer.gif)'></div>
			<div class="static" style='background-size:80%;background-image:url(./ahead-of-the-game-logo-white.png)'>
				<button class='next-screen click-to-next-screen'>GET STARTED ></button>
			</div>
			<div class="static click-to-hide popup" style='background-image:url(./popup-notification.jpg);background-size:80%;'></div>
		</div>
		<div class="screen">
			<h1>Intro scene</h1>
			<button class="click-to-next-screen">Continue ></button>
		</div>
		<div class="screen">
			<h1>Will you bounce back?</h1>
			<button class="click-to-next-screen">Continue ></button>
		</div>
		<div class='screen screen-video screen-stickers'>
			<video controls width="100%" height="100%;">
				<source src="./video/scene-1.mp4" type="">
			</video>
			<div class='overlay'></div>
			<div class='sticker-party'></div>
			<div class='timer'>
				<div class='timer-ticker'></div>
			</div>
		</div>
		<div class='screen screen-video'>
			<video preload controls width="100%" height="100%;">
				<source src="./video/pickup-1.mp4" type="">
			</video>
		</div>
		<div class='screen screen-video screen-stop-swipe'>
			<video preload controls width="100%" height="100%;">
				<source src="./video/reflection-1.mp4" type="">
			</video>
			<div class='overlay'></div>
			<div class='swipe-prompt'>
				<div class="finger"></div>
			</div>
			<div class='stop'>
				<div class='stop-banner'>
					<h1>STOP</h1>
					<h2>Don't get caught up in the things you can't control.</h2>
				</div>
				<br>
				<button class='next'>THERE'S A BETTER WAY ></button>
				
			</div>
		</div>

		<div class='screen' style="background-image: url(./josh-face.png);background-size: 100%;">
			<div class="instruct">
				<h1>POSITIVE THOUGHTS</h1>
				<img src="./choose-positive.svg" width="120" style='width:120;display:block;margin:auto;'><br>
					<b>Positive thoughts</b> are optimistic and motivational.
					<li>It will be fine.</li>
					<li>No problemo.</li>
					<li>You've got this.</li>
					<li>You can do it.</li>
					<br>
				<button class="next click-to-next-screen">GOT IT ></button>
			</div>

		</div>
		<div class='screen' style="background-image: url(./josh-face.png);background-size: 100%;">
			<div class="instruct">
			<h1>INSTRUCTIVE THOUGHTS</h1>
				<img src="./choose-instructional.svg" width="120" style='width:120;display:block;margin:auto;'><br>
					<p><b>Instructive thoughts</b> are actionable.</p>
					<li>I just need to keep training.</li>
					<li>I need to work harder.</li>
					<li>I just need to try again.</li>
					<p><b>Instructive thoughts</b> focus on what you should do, not what you shouldn't do.</p>
					<p style="text-align: center;"><i>"I should work on my catching."</i><br>
					instead of<br><i>"Stop dropping the ball."</i></p>
				<button class="next click-to-next-screen">GOT IT ></button>
			</div>
		</div>
		<div class="screen screen-strategy" style="background-image: url(./josh-face.png);background-size: 100%;">
			<iframe style='position: absolute;top:0px;left:0px;border:none;background:rgba(255,255,255,0.8);' src="./swipe-your-thoughts.html" width="400px" height="700px"></iframe>
		</div>
		<div class="screen screen-video">
			<video preload controls width="100%" height="100%;">
				<source src="./video/scene-2.mp4" type="">
			</video>
		</div>
		<div class="screen screen-video">
			<video preload controls width="100%" height="100%;">
				<source src="./video/pickup-2.mp4" type="">
			</video>
		</div>
		<div class="screen screen-video">
			<video preload controls width="100%" height="100%;">
				<source src="./video/reflection-2.mp4" type="">
			</video>
		</div>
		<div class="screen screen-video">
			<video preload width="100%" height="100%;">
				<source src="./video/transition.mp4" type="">
			</video>
		</div>
	</div>
	<div class="qr-prompt click-to-hide" style='background:rgba(255,255,255,0.9)'>
		<h2>Jump on the WIFI</h2>
		<img src='./qr-code.png'>
		<p>TeamLadsWIFI | PrettyFlyForAWifi</p>
		<h2>Download the app</h2>
		<img src='./qr-code.png'>
		<p>aotg.app.com</p>
		<div style="width:50px;height:50px;text-align:center;font-size:40px;position: absolute;top:0px;right:0px;">×</div>
	</div>
	<br><br>
	<div class="nav">
		
	</div>

</body>
</html>
<!DOCTYPE html>
<html>
<head>
	<title>Sticker Tuner</title>
	<script type="text/javascript" src='./jquery-3.4.1.min.js'></script>
	<script type="text/javascript">
		$(function(){

			var chapters = ['0:00','1:31','3:48','5:24','7:01','8:19','9:22']

			var moments = 
			[
				{start:'1:50',end:'1:51',options:['THIS SUCKS',"SCREW-UP ðŸ˜©",'$^#&%!']},
				{start:'2:03',end:'2:07',options:['100% LOSER','ðŸ˜‘ NUMPTY!',"I'LL NEVER LIVE THIS DOWN"]},

				{start:'4:25',end:'4:26',options:['DISASTER ðŸ’£!','UNBELIEVABLE!',"YOU'VE GOTTA BE JOKING!"]},
				{start:'4:33',end:'4:34',options:['This sucks!','Iâ€™m outta here ðŸƒ','$^#&% IT ALL!']},

				{start:'5:40',end:'5:43',options:["NOT FEELING IT TODAY",'WHAT AM I DOING HERE?','BLURGH ðŸ˜–']},
				{start:'6:09',end:'6:11',options:['GET OFF MY CASE ðŸ˜•',"WHY CAN'T I DO THIS!?",'GOTTA BEAT THIS!']},

				{start:'7:23',end:'7:24',options:['this is stupid','ðŸ¤¨ unfair','what attitude!? ðŸ¤¬']},
				{start:'7:28',end:'7:31',options:["IT'S NOT MY FAULT ðŸ˜¡","WHY ARE THEY HOLDING ME BACK!?","THEY DON'T UNDERSTAND!"]},

				{start:'9:08',end:'9:09',options:["just me and the ball ðŸ‰","ðŸ˜Œ keep calm","BREATHE"]},
				{start:'9:11',end:'9:13',options:["I can do this â­","I can do this ðŸ™‚","I can do this ðŸ’ª"]},
			]

			var v = $('video')[0];
			var wasTime = 999999;
			var iMomentActive = -1;
			var didSelection = false;

			

			function tick(){

				var iMoment = -1;
				for(var i in moments){
					if(v.currentTime > moments[i].start && v.currentTime < moments[i].end) iMoment = i;
				}

				if(iMoment != iMomentActive){

					if( !didSelection && iMomentActive > -1 && v.currentTime>moments[iMomentActive].end && v.currentTime<(moments[iMomentActive].end+0.5)){
						v.pause();
						$('.timer').width('100%');
					} else {
						$('.overlay').removeClass('active');
						
						if(iMoment>-1){
							$('.overlay').addClass('active');
							$('.stickers').empty();
							didSelection = false;

							for(var o in moments[iMoment].options){
								$('<div class="sticker text">').text(moments[iMoment].options[o]).click(onSticker).appendTo('.stickers').addClass('n'+o).css({opacity:0}).delay(1200).animate({opacity:1});
								$('<br>').appendTo('.stickers');
							}
						}
					}

					iMomentActive = iMoment;

					
				}
				else if(iMoment>-1){
					var delta = moments[iMomentActive].end - moments[iMomentActive].start;
					var p = (v.currentTime - moments[iMomentActive].start)/delta;
					$('.timer').width(p*100+'%');
				}
				
			}

			for(var i in chapters){
				chapters[i] = toSeconds(chapters[i]);
			}

			for(var i in moments){
				moments[i].start = toSeconds(moments[i].start);
				moments[i].end = toSeconds(moments[i].end);
			}

			for(var i in chapters){
				$('<button>').appendTo('.nav-chapters').text(i).click(onNav).data({time:chapters[i]});
			}

			for(var i in moments){
				$('<button>').appendTo('.nav-moments').text((parseInt(i)+1)).click(onNav).data({time:moments[i].start-1});
			}

			function toSeconds(timestamp){
				var arr = timestamp.split(':');
				return parseInt(arr[0])*60 + parseInt(arr[1]);
			}

			function onNav(){
				$('.overlay').removeClass('active');
				$('.stickers').empty();
				v.currentTime = $(this).data('time');
				v.play();
			}

			function onSticker(){
				
				$('.feature-overlay').empty();
				$(this).appendTo('.feature-overlay').delay(1000).animate({opacity:0});

				$('.stickers').empty();
				$('.overlay').removeClass('active');
				didSelection = true;

				v.play();
			}


			setInterval(tick,50);

		})
	</script>
	<style type="text/css">
		@font-face {
			font-family: "HeaderFont";
			src: url("./font-teko/Teko-Regular.ttf");
		}

		@font-face {
			font-family: "BodyFont";
			src: url("./Overpass-Light.ttf");
		}

		@font-face {
		  font-family: BodyFont;
		  src: url("./Overpass-Bold.ttf");
		  font-weight: bold;
		}	

		body{
			background: #333;
			font-family: "BodyFont";
			text-align: center;
			margin: 0px;
			padding: 0px;
		}

		.device{
			width: 400px;
			height: 708px;
			text-align: left;
			background: black;
			display: inline-block;
			position: relative;
			overflow: hidden;
		}

		.overlay{
			position: absolute;
			top: 0px;
			left: 0px;
			right: 0px;
			bottom: -10px;
			border-top: 0px solid black;
			border-bottom: 0px solid black;
			color: white;
			text-align: center;
			transition: all 1s;
			display: block;
		}

		.overlay.active{
			border-top-width: 100px;
			border-bottom-width: 100px;
			bottom: 0px;
		}

		.overlay.active h1{
			opacity: 1;
		}

		.feature-overlay{
			position: absolute;
			top: 0px;
			left: 0px;
			right: 0px;
			bottom: 0px;
		}

		.overlay h1{
			font-family: "HeaderFont";
			font-weight: normal;
			text-align: center;
			margin-top:50px;
			background: #1C44CE;
			display: inline-block;
			padding: 5px 20px;
			margin: 40px;
			border-radius: 5px;
			position: relative;
			opacity: 0;
			transition: all 1s;
		}

		.sticker{
			display: inline-block;
			margin: 15px;
			position: relative;	

			
			cursor: pointer;

			opacity: 0;


		}

		

		

		.sticker.text{
			padding: 5px 10px 0px;
			border: 3px solid white;
			color: white;
			font-weight: normal;
		
			transform: rotate(-5deg);
			background: orange; 
			text-transform: uppercase;
			font-size: 40px;
			box-shadow: 0px 1px 5px rgba(0,0,0,0.3);
			font-family: "HeaderFont";
			text-shadow: 0px 2px 0px #F25031;
			white-space: nowrap;
			line-height: 60px;
		}

		.sticker.featured{
			margin-top:150px;
			transform: rotate(-5deg) scale(2);
			transition: all 0s;
		}

		.stickers{
			text-align: center;
		}

		.sticker.n0{ background: #F7B752; text-shadow: 0px 2px 0px red; }
		.sticker.n1{ background: #99DB4D; text-shadow: 0px 2px 0px green; }
		.sticker.n2{ background: #82C8F2; text-shadow: 0px 2px 0px blue; }
		.sticker.n3{ background: #E66376; text-shadow: 0px 2px 0px red; }

		.overlay h1:after {
			content: "";
			width: 0; 
			height: 0; 
			border-left: 12px solid transparent;
			border-right: 12px solid transparent;
			border-top: 12px solid #1C44CE;
			position: absolute;
			bottom: -12px;
			left: calc(50% - 6px);
		}

		.nav button{
			width: 45px;
			border: none;
			margin-right: 1px;
		}

		.nav-chapters button{
			width: 91px;
		}

		.nav-moments{
			padding-left: 93px;
		}

		.nav-wrapper{
			text-align: left;
			display: inline-block;
		}

		.feature-overlay{
			text-align: center;
			line-height: 700px;

		}

		.feature-overlay .sticker{
			transform: rotate(-5deg) scale(2);
		}

		.timer{
			position: absolute;
			bottom: 0px;
			height: 10px;
			background: white;
			margin: auto;
			width: 50%;
			display: block;
			left: 0px;
			right: 0px;
		}

	</style>
</head>
<body>
	<div class="device">
		<div class="screen">
			<video width=400 height=708 src='./video/full-edit.mp4'></video>
			<div class="feature-overlay">

			</div>
			<div class="overlay">
				<h1>WHAT'S HE THINKING?</h1>
				<div class="stickers"></div>
				<div class="timer"></div>
			</div>
			
		</div>
	</div>
	<br>
	<div class="nav-wrapper">
		<div class="nav nav-chapters"></div>
		<div class="nav nav-moments"></div>
	</div>
</body>
</html>